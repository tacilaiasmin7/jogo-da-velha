!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jogo da velha</title>
</head>
<style>
  body {
    font-family: Arial, sans-serif;
    text-align: center;
    margin: 20px;
    background-color: #f9f9f9;
  }

  .container {
    max-width: 320px;
    margin: 0 auto;
  }

  h1 {
    margin-bottom: 10px;
  }

  .placar {
    margin-bottom: 15px;
    font-weight: bold;
  }

  #mensagem {
    margin-bottom: 15px;
    font-size: 18px;
    font-weight: 600;
  }

  #tabuleiro {
    display: grid;
    grid-template-columns: repeat(3, 80px);
    grid-template-rows: repeat(3, 80px);
    gap: 5px;
    justify-content: center;
    margin-bottom: 15px;
  }

  #tabuleiro > div {
    background-color: #fff;
    border: 2px solid #333;
    font-size: 36px;
    font-weight: bold;
    color: #333;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    user-select: none;
    transition: background-color 0.3s ease;
  }

  #tabuleiro > div:hover {
    background-color: #e0e0e0;
  }

  button {
    padding: 8px 16px;
    margin: 5px;
    font-size: 16px;
    cursor: pointer;
    border: 1px solid #333;
    background-color: #fff;
    transition: background-color 0.3s ease;
  }

  button:hover {
    background-color: #ddd;
  }
</style>
<body>
 <div class="container">
    <h1>Jogo da velha</h1>
<div class="placar">
Jogador X: <span id="pontosX">0</span>| Jogador O: <span id="pontosO">0</span>| Empates: <span id="pontosEmpate">0</span>
</div>
<div class="mensagem" id="mensagem">É a vez do jogador X</div>
<div class="tabuleiro" id="tabuleiro">
    <div onclick="mover(0)"></div>
    <div onclick="mover(1)"></div>
    <div onclick="mover(2)"></div>
    <div onclick="mover(3)"></div>
    <div onclick="mover(4)"></div>
    <div onclick="mover(5)"></div>
    <div onclick="mover(6)"></div>
    <div onclick="mover(7)"></div>
    <div onclick="mover(8)"></div>
</div>
    <button class="btn" onclick="reiniciar()">Reiniciar o jogo</button>
    <button class="bto" onclick="desfazer()">Desfazer a última jogada</button>
    
<script>
    let jogadorAtual="X";
    let tabuleiroEstado=["","","","","","","","",""];
    let fimdejogo= false;
    let historico=[];
    let pontosX= 0;
    let pontosO= 0;
    let pontosEmpate= 0;
    const men= document.getElementById("mensagem");
    const tab= document.getElementById("tabuleiro");
    const pntsX= document.getElementById("pontosX");
    const pntsO= document.getElementById("pontosO");
    const pntsemp= document.getElementById("pontosEmpate");
    const elementoTabuleiro = document.getElementById("tabuleiro");


    function mover(index) {
        if(tabuleiroEstado[index] !== ""|| fimdejogo) return;

        tabuleiroEstado[index] = jogadorAtual;
        historico.push({ jogador: jogadorAtual, posicao: index });

        const celula = elementoTabuleiro.children[index];
        celula.textContent = jogadorAtual;
        celula.classList.add('move-animation');
        
        
        if (checarVencedor()) {
            men.textContent = `Jogador ${jogadorAtual} venceu!`;
            atualizarPlacar ();
            fimdejogo = true;
            return;

    }
        if (!tabuleiroEstado.includes("")) {
    men.textContent = "Empate!";
    pontosEmpate++;
    pntsemp.textContent = pontosEmpate;
    fimdejogo = true;
    return;
}


            jogadorAtual = jogadorAtual == "X" ? "O" : "X";
            men.textContent = `È a vez do jogador ${jogadorAtual}`;

        }

    

    // função checar vencedor
    function checarVencedor() {
        const combinacoes = [
            [0,1,2], [3,4,5], [6,7,8], // linhas //
            [0,3,6], [1,4,7], [2,5,8], // colunas //
            [0,4,8], [2,4,6]   // diagonais //
    ];       
        
    // verifica se alguma das combinações é igual para o jagador atual
    return combinacoes.some(([a,b,c])=> {
        return (
        tabuleiroEstado[a] === jogadorAtual &&
                tabuleiroEstado[b] === jogadorAtual &&
                tabuleiroEstado[c] === jogadorAtual
            );
            });
    }
    // função: reiniciar jogo //
    function reiniciar() {
     tabuleiroEstado.fill("") // limpa array //
     historico = [];        // limpa historico //
     jogadorAtual = "X"; // X começa sempre //
     fimdejogo = false;
     men.textContent = "É a vez do jogador X"
     
     
     // limpa cada célula visualmente
     for (let celula of elementoTabuleiro.children) {
        celula.textContent = "";
     }
    }
    
    // função de desfazer jogada //
    function desfazer(){
        if (historico.length == 0 || fimdejogo) return; // se não dá pra fazer, sai //

        const ultimajogada = historico.pop(); // remove última jogada //
        tabuleiroEstado[ultimajogada.posicao] = ""; // limpa tabuleiro lógico //
        elementoTabuleiro.children[ultimajogada.posicao].textContent=""; // limpa tela //

        jogadorAtual = ultimajogada.jogador; // devolve a vez //
        men.textContent = `É a vez do jogador ${jogadorAtual}`;
        fimdejogo= false;
    }

    // função atualiza placar
function atualizarPlacar() {
    if (jogadorAtual == "X"){
        pontosX ++;
        pntsX.textContent= pontosX;
    }
    else {
        pontosO ++;
        pntsO.textContent = pontosO;
    }
}
</script>
</body>
</html>